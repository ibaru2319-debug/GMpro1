<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GMpro1 Control Center</title>
    <style>
        body { background: #050505; color: #00ff41; font-family: 'Courier New', monospace; padding: 10px; margin: 0; text-shadow: 0 0 5px #00ff41; }
        .header { text-align: center; border-bottom: 2px solid #00ff41; padding-bottom: 10px; margin-bottom: 10px; }
        
        /* Grid Kontrol */
        .control-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .btn { padding: 12px; text-align: center; font-weight: bold; text-decoration: none; border-radius: 4px; border: 1px solid #00ff41; background: #000; color: #00ff41; font-size: 11px; cursor: pointer; transition: 0.3s; }
        .btn:active { transform: scale(0.95); }
        .on { background: #ff0000; color: #fff; border: none; box-shadow: 0 0 15px #ff0000; }
        .stop { background: #ffae00; color: #000; border: none; box-shadow: 0 0 10px #ffae00; }
        .blue { background: #0055ff; color: #fff; border: none; }
        
        /* Tabel WiFi */
        table { width: 100%; border-collapse: collapse; margin-top: 15px; background: rgba(0,20,0,0.3); }
        th { text-align: left; border-bottom: 2px solid #00ff41; padding: 8px; font-size: 10px; color: #888; }
        td { padding: 10px 8px; border-bottom: 1px solid #222; font-size: 11px; }
        .sel-btn { padding: 5px 10px; background: #00ff41; color: #000; border: none; font-size: 10px; font-weight: bold; border-radius: 3px; cursor: pointer; }

        /* Log Box */
        pre { background: #000; border: 1px solid #333; padding: 10px; height: 120px; overflow-y: scroll; color: #00ff41; font-size: 9px; margin-top: 10px; white-space: pre-wrap; }
        .box { border: 1px solid #333; padding: 12px; border-radius: 8px; margin-top: 15px; }
        h4 { margin: 10px 0 5px 0; color: #00ff41; text-transform: uppercase; }
    </style>
</head>
<body>

    <div class="header">
        <h2 style="margin:0;">GMpro1 <span style="color:red;">ULTIMATE</span></h2>
        <small>Control Center: GMpro1 Online</small>
    </div>

    <div class="control-grid">
        <div class="btn on" onclick="runAction('attack?type=deauth')">DEAUTH</div>
        <div class="btn" onclick="runAction('attack?type=mass_deauth')">MASS DEAUTH</div>
        <div class="btn stop" onclick="runAction('stop')">STOP ACTIVE!</div>
        <div class="btn blue" onclick="runAction('attack?type=clone')">BEACON CLONE</div>
        <div class="btn" style="grid-column: span 2; border-style: dashed; color: yellow;">PRANK MODE: ACTIVE ON TARGET</div>
    </div>

    <table>
        <thead>
            <tr><th>SSID</th><th>CH</th><th>SIGNAL</th><th>ACT</th></tr>
        </thead>
        <tbody id="wifi-list">
            <tr><td colspan="4" style="text-align:center;">Scanning networks...</td></tr>
        </tbody>
    </table>

    <h4>CRITICAL LOGS</h4>
    <pre id="log-box">[SYSTEM] Initializing GMpro1...</pre>

    <div class="box">
        <h4>FILE MANAGER</h4>
        <input type="file" id="file-input" style="font-size:10px; margin-bottom:10px; width: 100%;">
        <button class="btn" style="width:100%; background:#00ff41; color:#000;" onclick="alert('Upload feature requires SPIFFS handler')">UPLOAD HTML</button>
    </div>

    <script>
        // Fungsi kirim perintah ke ESP8266
        function runAction(path) {
            fetch('/' + path).then(response => {
                console.log("Command sent: " + path);
            });
        }

        // Ambil Log Real-time
        function updateLogs() {
            fetch('/get_logs')
            .then(res => res.text())
            .then(data => {
                document.getElementById('log-box').innerText = data;
            });
        }

        // Scan WiFi dan Update Tabel
        function scanWifi() {
            fetch('/scan')
            .then(res => res.json())
            .then(data => {
                let tbody = document.getElementById('wifi-list');
                if (data.length === 0) return;
                
                tbody.innerHTML = '';
                data.forEach(net => {
                    let row = `<tr>
                        <td>${net.ssid}</td>
                        <td>${net.ch}</td>
                        <td><div style="background:#00ff41; height:5px; width:${Math.abs(net.sig)}px; max-width:40px;"></div> ${net.sig}</td>
                        <td><button class="sel-btn" onclick="runAction('attack?type=deauth')">SELECT</button></td>
                    </tr>`;
                    tbody.innerHTML += row;
                });
            });
        }

        // Interval Update
        setInterval(updateLogs, 2000);
        setInterval(scanWifi, 5000);
    </script>
</body>
</html>
